<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PropCheck — Report</title>
  <link rel="stylesheet" href="assets/css/styles.css" />
  <script src="assets/js/config.js"></script>
  <script src="assets/js/state.js"></script>
</head>
<body>
  <header class="pc-hero">
    <nav class="pc-nav container">
      <a class="pc-logo" href="index.html"><span class="pc-logo-emoji">🏠</span><span class="pc-logo-text">PropCheck</span></a>
      <div class="pc-links">
        <a href="calculator.html">Calculator</a>
        <a href="reports.html" class="active">Report</a>
        <a href="analysis.html">Analysis</a>
      </div>
    </nav>
    <div class="pc-hero-title container">
      <h1>Property Investment Report</h1>
      <p class="muted">Generated on <span id="genDate"></span></p>
    </div>
  </header>

  <main class="container">
    <div class="pc-card pc-card-large">
      <h2 class="pc-section"><span>🏡</span> Summary</h2>
      <div id="summary"></div>

      <h2 class="pc-section"><span>📋</span> Property Overview</h2>
      <table class="pc-table" id="tblOverview"></table>

      <h2 class="pc-section"><span>🏦</span> Financing</h2>
      <table class="pc-table" id="tblFinance"></table>

      <h2 class="pc-section"><span>💸</span> Income & Expenses</h2>
      <table class="pc-table" id="tblIE"></table>

      <div class="actions">
        <a class="pc-btn pc-btn-outline" href="calculator.html">Back to Calculator</a>
        <a class="pc-btn pc-btn-primary" href="analysis.html">Go to Analysis</a>
      </div>
    </div>
  </main>

  <footer class="container pc-footer">Styled to match original PropCheck</footer>

  <script>
    const d = PCState.getDeal();
    document.getElementById('genDate').textContent = new Date().toLocaleDateString('en-CA');

    const fmtC = n => PC.money(Number(n||0));
    const pct = n => (Number(n||0)).toFixed(2) + '%';

    if (!d) {
      document.getElementById('summary').innerHTML = '<p class="muted">No saved deal. Go to Calculator and save one.</p>';
    } else {
      document.getElementById('summary').innerHTML = `
        <div class="pc-kpis">
          <div class="pc-kpi"><div class="kpi-label">Price</div><div class="kpi-value">${fmtC(d.purchasePrice)}</div></div>
          <div class="pc-kpi"><div class="kpi-label">Rent (mo)</div><div class="kpi-value">${fmtC(d.monthlyRent)}</div></div>
          <div class="pc-kpi"><div class="kpi-label">Vacancy</div><div class="kpi-value">${pct(d.vacancyPct)}</div></div>
        </div>
      `;

      const ov = [
        ['Name', d.title || '(unnamed)'],
        ['Purchase Price', fmtC(d.purchasePrice)],
        ['Closing Costs', fmtC(d.closingCosts)],
        ['Renovation Budget', fmtC(d.renoBudget)]
      ];
      fillTable('tblOverview', ov);

      const fin = [
        ['Down Payment %', pct(d.downPct)],
        ['Interest Rate %', pct(d.ratePct)],
        ['Amortization (yrs)', d.amortYears || 0],
        ['Term (yrs)', d.termYears || 0]
      ];
      fillTable('tblFinance', fin);

      const ie = [
        ['Monthly Rent', fmtC(d.monthlyRent)],
        ['Other Monthly Income', fmtC(d.otherIncome)],
        ['Vacancy %', pct(d.vacancyPct)],
        ['Property Tax (annual)', fmtC(d.taxAnnual)],
        ['Insurance (annual)', fmtC(d.insAnnual)],
        ['Utilities (monthly)', fmtC(d.utilsMonthly)],
        ['Maintenance % of Rent', pct(d.maintPct)],
        ['CapEx % of Rent', pct(d.capexPct)],
        ['Management % of Rent', pct(d.mgmtPct)]
      ];
      fillTable('tblIE', ie);
    }

    function fillTable(id, rows){
      const el = document.getElementById(id);
      el.innerHTML = rows.map(([k,v])=>`<tr><td>${k}</td><td class="val">${v}</td></tr>`).join('');
    }
  </script>
</body>
</html>

